# Eigenvalue and Eigenvector Calculation

## Theoretical Background
The intent `processEigenModesDampedPara()` is to take a granular packings located in `in_path` and compute the eigenvalues and eigenvectors of these packings under damped conditions. The core functionality of `processEigenModesDampedPara()` creates the matricies for and solves the equation:

$$
\mathbf{M} \ddot{\mathbf{x}} + \mathbf{\Gamma} \dot{\mathbf{x}} + \mathbf{K} \mathbf{x} = \mathbf{0}
$$

where $\mathbf{M}$ is the mass matrix, $\mathbf{\Gamma}$ is the damping matrix, and $\mathbf{K}$ is the stiffness matrix.

These matrices are generated by `matSpringDampMass()` within `processEigenModesDampedPara()`.

`processEigenModesDampedPara()` then uses `polyeig()` which assumes a solution of the form $\mathbf{x} = \mathbf{v} e^{\lambda t}$, and for eigenvalues and eigenvectors:

- For $f$ degrees of freedom per particle and $N$ particles, the eigenvector matrix is of size $fN \times 2fN$.
- The eigenvalue vector $\lambda$ is of size $2fN \times 1$.
- Each row of $\lambda$ corresponds to a column of the eigenvector matrix.
- The $2fN$ size arises because the system produces conjugate pairs of eigenvalues for each mode.

For the scalar case, the eigenvalues are:
$$
\lambda_i = -\frac{\gamma_i}{2m_i} \;\pm\; i\sqrt{\frac{k_i}{m_i} - \Bigl(\tfrac{\gamma_i}{2m_i}\Bigr)^{\!2}}
$$

Here, $\lambda_i$ is the $i$-th eigenvalue of the system, which characterizes the time evolution of the $i$-th mode. Each $\lambda_i$ can be complex, and complex conjugate pairs correspond to oscillatory (underdamped) modes. The real part of $\lambda_i$ determines the rate of exponential decay (damping), while the imaginary part determines the oscillation frequency of the mode.

Since the mass matrix $\mathbf{M}$ and the spring matrix $\mathbf{K}$ are sparse, and we are mainly interested in eigenvalues with small imanginary componnets, other more efficient methids suche as `eigs()` or `sparse()` can be used to compute the eigenvalues and eigenvectors. 

## Relavant Functions
- [processEigenModesDampedPara.m](https://github.com/ColtonKawamura/GranMA/blob/main/src/matlab_functions.processEigenModesDampedPara.m)
    - This function is the main entry point for computing eigenvalues and eigenvectors of granular packings.
- [matSpringDampMass.m](https://github.com/ColtonKawamura/GranMA/blob/main/src/matlab_functions/matSpringDampMass.m)
    - This function generates the mass, damping, and stiffness matrices for the granular packing.
    - It is called within `processEigenModesDampedPara()` to create the matrices needed for the eigenvalue problem.
- [cleanRats.m](https://github.com/ColtonKawamura/GranMA/blob/main/src/matlab_functions/cleanRats.m)
    - This function cleans any rattler particles from the data from the packing.


## Example Usage

**Prequisites:**
- Ensure packings are of them same geometrty and have the same number of particles.
- Ensure the packings are in the correct format (e.g., `.mat` files).
- The only difference between the packings shoudl be their preesures.

```matlab
dampingValues = [0.1, 0.2, 0.3]; % Example damping values
processEigenModesDampedPara("path/to/your/packings/", "your/output/path/", dampingValues,"periodic", true);
```

Then you can access the output data with

```matlab
load("your/output/path/2D_damped_eigenstuff_NXXXX_XXbyXX_K100_M1.mat")
```
